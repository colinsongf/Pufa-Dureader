add train_file
vocab size is  1237
after filtered vocab size is  667
over_map word num is  582
[0;30;46m WHY Info: Prepare complete. [0m 
add train_file
add dev_file
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:85: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_p.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:86: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_q.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:87: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_r.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:88: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  torch.nn.init.normal(self.w.data, mean=0, std=0.05)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:41: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:42: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_r.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:43: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.out_l.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:44: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_mask.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:45: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  torch.nn.init.normal(self.w.data, mean=0, std=0.05)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:225: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.V.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:226: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(self.W_a.weight.data, gain=1)
/disk/Pufa-Dureader/my_dureader_single/layers/eric_temp_layers.py:229: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  torch.nn.init.normal(self.v.data, mean=0, std=0.05)
total number of parameters: 3294452
number of trainable parameters: 3294452
Training the model for epoch 1
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:221: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  total_loss += loss.data[0]
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:222: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  n_batch_loss += loss.data[0]
Average train loss for epoch 1 is 8.710726737976074
Evaluating the model after epoch 1
[0;30;46m WHY Info: result_dir is: None. [0m 
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:291: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  p = Variable(torch.LongTensor(batch['passage_token_ids']), volatile=True).cuda()
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:293: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  q = Variable(torch.LongTensor(batch['question_token_ids']), volatile=True).cuda()
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:295: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  start_label = Variable(torch.LongTensor(batch['start_id']), volatile=True).cuda()
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:416: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  if prob.data[0] > max_prob:
/disk/Pufa-Dureader/my_dureader_single/my_rc_model.py:419: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  max_prob = prob.data[0]
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
/home/dian/.virtualenvs/ml/lib/python3.5/site-packages/numpy/core/fromnumeric.py:2957: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dian/.virtualenvs/ml/lib/python3.5/site-packages/numpy/core/_methods.py:80: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_1.
Training the model for epoch 2
Average train loss for epoch 2 is 8.389877319335938
Evaluating the model after epoch 2
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_2.
Training the model for epoch 3
Average train loss for epoch 3 is 7.317968845367432
Evaluating the model after epoch 3
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_3.
Training the model for epoch 4
Average train loss for epoch 4 is 6.3737993240356445
Evaluating the model after epoch 4
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_4.
Training the model for epoch 5
Average train loss for epoch 5 is 6.018792629241943
Evaluating the model after epoch 5
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_5.
Training the model for epoch 6
Average train loss for epoch 6 is 5.948562145233154
Evaluating the model after epoch 6
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_6.
Training the model for epoch 7
Average train loss for epoch 7 is 5.360028266906738
Evaluating the model after epoch 7
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_7.
Training the model for epoch 8
Average train loss for epoch 8 is 4.93764066696167
Evaluating the model after epoch 8
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_8.
Training the model for epoch 9
Average train loss for epoch 9 is 4.811455726623535
Evaluating the model after epoch 9
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_9.
Training the model for epoch 10
Average train loss for epoch 10 is 4.58742618560791
Evaluating the model after epoch 10
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
Dev eval result: {'Bleu-4': 0.0, 'Bleu-3': 0.0, 'Bleu-2': 0.0, 'Bleu-1': 0.0, 'Rouge-L': nan}
Model saved in ../data/models_search_pretrain/yesno, with prefix BIDAF_10.
[0;30;46m WHY Info: Data train complete. [0m 
add dev_file
total number of parameters: 3294452
number of trainable parameters: 3294452
Model restored from ../data/models_search_pretrain/yesno, with prefix BIDAF_7
[0;30;46m WHY Info: result_dir is: None. [0m 
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 208
correct passage num is 0 in 208
[0;30;46m WHY Info: Dev data evaluate complete. [0m 
add test_file
total number of parameters: 3294452
number of trainable parameters: 3294452
Model restored from ../data/models_search_pretrain/yesno, with prefix BIDAF_10
[0;30;46m WHY Info: result_dir is: ../data/results_demo/yesno. [0m 
Saving test.predicted.BIDAF_10 results to ../data/results_demo/yesno/test.predicted.BIDAF_10.json
{'guess': [0, 0, 0, 0], 'reflen': 0, 'correct': [0, 0, 0, 0], 'testlen': 0}
ratio: 1e-06
correct selected passage num is 0 in 358
correct passage num is 0 in 358
[0;30;46m WHY Info: Test data predict complete. Everything done. [0m 
